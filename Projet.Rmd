---
title: "Projet"
author: "Mai Chi Do, Heloise ROZIER, Romane LE GOFF"
date: "10/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r,include=FALSE}
library(sf)
library(dplyr)
library(tidyverse)
# Pour les modeles d'econometrie spatiale
library(spdep)
#Pour le calcul de distance (fonction rdist)
library(fields)
#Pour la lecture de table SAS (fonction read.sas7bdat)
library(sas7bdat)
# Pour la cartographie
library(RColorBrewer)
library(classInt)
library(Guerry)
library(GISTools)
library(sp)
```

# Importation des données

```{r}
data(gfrance85)
```

# Cartographie

```{r}
my.palette <- brewer.pal(n = 7, name = "OrRd")

spplot(gfrance85,"Crime_pers", col.regions = my.palette, cuts = 6, col = "transparent", main="Nombre de crimes contre des personnes en France (1833)")
```

# Calculer des centroides des departements

```{r}
centroids <- coordinates(gfrance85)
```

# Matrice de contiguité

## Definition de voisins

```{r}
voisins <- poly2nb(gfrance85)
summary(voisins)
```

`r gfrance85$Department[c(22,26,54,59,63,65,70)] ` sont les départements les plus isolés, tandis que `r gfrance85$Department[46] ` et `r gfrance85$Department[72] `
les plus connectées.

## Matrice de contiguité

```{r}
### Matrice de contiguite standardisee en ligne, methode par defaut
cont.w <- nb2listw(voisins,style="W")
```

## Autocorrélation spatiale globale

```{r}
### Test de Moran, Donnees Brutes
moran.test(gfrance85$Crime_pers, cont.w, zero.policy=TRUE) # permet de recup la stat de Moran

### Graphique de Moran
op <- par(mar=c(5, 6, 4, 2) + 0.1)
moran.plot(x=gfrance85$Crime_pers,cont.w,xlab="Crimes contre des personnes par département",
           ylab="W * Crimes contre des personnes\npar département",
           zero.policy=TRUE)
par(op)

### Test de Geary
geary.test(gfrance85$Crime_pers, cont.w, zero.policy=TRUE)
```

